# 更新指南

## ⚠️ 常见问题

### UAC 权限被拒绝

如果在更新时遇到"UAC权限被拒绝"错误，请按以下步骤操作：

#### 方法一：以管理员身份运行（推荐）

1. **关闭应用**
2. 找到应用的快捷方式或可执行文件
3. **右键点击** → 选择 **"以管理员身份运行"**
4. 在应用中再次点击"检查更新"
5. 当 UAC 弹窗出现时，点击 **"是"** 允许权限

#### 方法二：在更新窗口中重试

1. 当更新失败显示错误信息时
2. 点击下方的 **"重试安装"** 按钮
3. 当 UAC 弹窗出现时，点击 **"是"** 允许权限

#### 方法三：手动下载安装

如果以上方法都不行，可以手动下载最新版本：

1. 访问 [GitHub Releases](https://github.com/GigaPuddings/snippets-code-t/releases)
2. 下载最新版本的安装包
3. 运行安装包进行更新

---

## 🔍 为什么需要管理员权限？

应用安装在 `C:\Program Files` 目录下，Windows 默认需要管理员权限才能修改该目录的文件。
更新程序需要替换旧版本文件，因此需要管理员权限。

---

## 🛡️ 安全提示

- 应用使用数字签名保证安全性
- 只从官方 GitHub Releases 下载更新
- 请勿从第三方渠道下载应用

---

## 📝 技术说明

### NSIS 安装程序配置

应用使用 NSIS 安装程序，配置为 `perMachine` 模式：
- 安装位置：`C:\Program Files\snippets-code`
- 需要管理员权限
- 所有用户共享同一个安装

### 更新机制

1. **检查更新**：从 GitHub Releases 获取最新版本信息
2. **下载更新**：下载新版本的安装包（带数字签名）
3. **启动安装**：运行安装程序（需要 UAC 权限）
4. **完成更新**：安装完成后自动重启应用

---

## 🐛 其他问题

### 更新文件签名验证失败

可能是下载过程中文件损坏，请：
1. 点击"重试安装"重新下载
2. 检查网络连接是否稳定
3. 尝试手动下载安装

### 网络连接失败

1. 检查网络连接
2. 如果 GitHub 访问慢，应用会自动尝试镜像地址
3. 可以手动从 GitHub 下载安装包

### 被杀毒软件拦截

1. 将应用添加到杀毒软件白名单
2. 临时关闭杀毒软件后重试
3. 应用已签名，是安全的

---

## 💡 反馈问题

如果遇到其他问题，请：
1. 查看日志文件：`%APPDATA%\com.snippets-code.app\logs`
2. 在 [GitHub Issues](https://github.com/GigaPuddings/snippets-code-t/issues) 提交问题
3. 提供详细的错误信息和日志
